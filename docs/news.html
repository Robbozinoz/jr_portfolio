<!DOCTYPE html>
<html lang="en">

<head>
<<<<<<< HEAD
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NYT Top Stories</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300&display=swap" rel="stylesheet">
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.0/css/bulma.min.css'>
    <link rel="stylesheet" href="css/main.css" />
    <style>
=======
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>NYT Top Stories</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300&display=swap" rel="stylesheet"> 
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.0/css/bulma.min.css'>
	<style>
>>>>>>> b1141b54ebf917f8cbf7630e03cc4bcc4c1835b2
        article {
            background: #f2f5ff;
            margin-bottom: 14px;
            border-bottom: 2px solid #ffd259;
        }

        article h2 a {
            color: #1c38fe;
        }

        button {
            width: 400px;
            height: 2em;
            font-size: 1.25em;
        }
<<<<<<< HEAD

        .news-heading {
            /* font-weight: 800; */
            text-transform: capitalize;
            font-size: 2em;
        }
=======
>>>>>>> b1141b54ebf917f8cbf7630e03cc4bcc4c1835b2
    </style>
</head>

<body class="container">
<<<<<<< HEAD
    <main class="main-header">
        <h1 class="lg-heading">Latest News</h1>
=======
    <main>
        <h1>Latest News</h1>
>>>>>>> b1141b54ebf917f8cbf7630e03cc4bcc4c1835b2
        <div id="app">
            <!--Place articles inside here-->
            <!--Possible loading quote-->
        </div>
<<<<<<< HEAD
        <button class="btn-dark" id="getButton">
            Get the Latest
        </button>
=======

        <button class="btn-dark" id="getButton">
            Get the Latest
        </button>

>>>>>>> b1141b54ebf917f8cbf7630e03cc4bcc4c1835b2
    </main>
    <footer id="main-footer">
        <div class="footer-icons">
            <a href="https://www.linkedin.com/in/jrobertson1/" target="_blank"> <i class="fab fa-linkedin fa-2x"></i>
            </a>
            <a href="https://github.com/Robbozinoz" target="_blank"> <i class="fab fa-github fa-2x"></i> </a>
        </div>
<<<<<<< HEAD
        <div>Copyright&copy; Room 5 Web Development 2021</div>
=======
        <div>Copyright&copy; Room 5 Web Development 2019</div>
>>>>>>> b1141b54ebf917f8cbf7630e03cc4bcc4c1835b2
    </footer>
    <script>
        //Declare button variable
        //var btn = document.querySelector('#getButton');

        //Declare Top Stories variable
        var stories = document.querySelector('#app');

        //The API key
        var apiKey = 'fyxIGmfhOMkSkE5TdtRCQbAObeu3rjXo';

        //Set the sections to be retrieved from the API
        var sections = ['arts', 'movies', 'sports', 'travel', 'world'];

        //Sert the number of articles from each section
        var articleNumber = 5;

        /**
         * Sanitize and encode all HTML in a user-submitted string
         * @param  {String} str  The user-submitted string
         * @return {String} str  The sanitized string
         */
        var sanitizeHTML = function (str) {
            var temp = document.createElement('div');
            temp.textContent = str;
            return temp.innerHTML;
        };

        /**
         * Render articles into the DOM
         * @param  {Array} topStories The articles to render
         */
        //Variable for the array of stories
        var storyArray = function (topStories, section) {
            //Map array of stories to Article element
            //Joined to a single array
<<<<<<< HEAD
            stories.innerHTML += '<h2 class="news-heading text-secondary">' + sanitizeHTML(section) + '</h2>' +
                topStories.map(
                    function (article) {
                        var html =
                            '<article class="box">' +
                            '<h2><a class="button is-link is-light" href="' + sanitizeHTML(
                                article.url) + '">' +
                            sanitizeHTML(article.title) +
                            '</a></h2>' +
                            '<p class="content">' + sanitizeHTML(article.byline) + '</p>' +
                            '<p class="content">' + sanitizeHTML(article.abstract) + '</p>' +
                            '</article>';
                        return html;
                    }).join('');
=======
            stories.innerHTML += '<h2>' + sanitizeHTML(section) + '</h2>' + topStories.map(function (article) {
                var html =
                    '<article class="box">' +
                    '<h2><a class="button is-link is-light" href="' + sanitizeHTML(article.url) + '">' +
                    sanitizeHTML(article.title) +
                    '</a></h2>' +
                    '<p class="content">' + sanitizeHTML(article.byline) + '</p>' +
                    '<p class="content">' + sanitizeHTML(article.abstract) + '</p>' +
                    '</article>';
                return html;
            }).join('');
>>>>>>> b1141b54ebf917f8cbf7630e03cc4bcc4c1835b2
        };

        /**
         * Get articles for a section
         * @param   {String} section The section name
         * @return  {Array} storyArray The rendering of the stories
         */
        //Function to fetch then map then place inner html & catch errors
        var getStories = function (section) {
            //Fetch the NYT top stories from the API
            fetch('https://api.nytimes.com/svc/topstories/v2/' + section + '.json?api-key=' + apiKey).then(
                function (
                    response) {
                    //Check the response and also provide error response
                    return response.ok ? response.json() : Promise.reject(response);
                }).then(function (data) {
                // Get the number of articles chosen
                var articleQuota = getarticleQuota(data.results);

                //Place data in the array Array
                storyArray(articleQuota, section);

            }).catch(function (error) {
                //create Catch for response error
                stories.textContent = '[Something went wrong, sorry!].', error;
            });
        }

        /**
         * Get the chosen number of articles from the full data set
         * @param  {Array} articles The full set of articles
         * @return {Array}          The chosen amount of articles in articleNumber
         */
        var getarticleQuota = function (articles) {
            return articles.slice(0, articleNumber);
        };

        /**
         * Get the section for the articles and send to teh API call function
         * @param  {Array} sections The section chosen
         */
        sections.forEach(function (section) {
            getStories(section);
        });

        // //Create event listener to initiate api call
        // btn.addEventListener('click', getSection, false)
    </script>
    <script
        src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.map%2Cdefault%2CMap%2CPromise%2Cfetch%2CArray.prototype.indexOf">
    </script>
</body>

</html>